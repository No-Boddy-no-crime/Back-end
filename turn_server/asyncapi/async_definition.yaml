asyncapi: 2.2.0
info:
  title: Clue game client
  version: '0.1.0'

servers:
  production:
    url: our_clue_game_will_live_here.com
    protocol: ws # websocket  
    description: This is the message broker for game state subscriptions

channels:
  game_turn:
    publish:
      message:
        $ref: "#/components/messages/gameTurn"
    subscribe:
      message:
        $ref: "#/components/messages/gameTurn"
  game_state:
    publish:
      message:
        $ref: "#/components/messages/gameState"
    subscribe:
      message:
        $ref: "#/components/messages/gameState"

components:
  messages:
    gameTurn:
      name: gameTurn
      title: game turn
      summary: Inform about which player is currently acting
      contentType: application/json
      traits:
        - $ref: '#/components/messageTraits/commonHeaders'
      payload:
        $ref: "#/components/schemas/game_turn"
    gameState:
      name: gameState
      title: game state
      summary: Inform about state of given game board
      contentType: application/json
      traits:
        - $ref: '#/components/messageTraits/commonHeaders'
      payload:
        $ref: "#/components/schemas/game_state"
  
  messageTraits:
    commonHeaders:
      headers:
        type: object
        properties:
          game_board_id:
            $ref: "#/components/schemas/game_board_id"
          player_id:
            $ref: "#/components/schemas/player"
  
  schemas:
    
    gameState:
      description: An object which holds which players are located in which room or hallway
      type: object
      additionalProperties: false
      properties:
        sent_at:
          $ref: "#/components/schemas/sent_at"
        game_board_id:
          $ref: "#/components/schemas/game_board_id"
        board:
          type: array
    
    player:
      description: An object which stores a player's unique ID, and which character they currently are
      type: object
      properties:
        player_id:
          type: string
          format: UUID
          description: a unique identifier for a player
        character_name:
          type: string
          format: enum
    
    game_board_id:
      type: string
      format: UUID
      description: a unique identifier for a game board
    
    sent_at:
      type: string
      format: date-time
      description: Date and time when the message was sent.



